<style>
  .rmu-sheet { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; max-width: 800px; color: #333; line-height: 1.4; font-size: 14px; background-color: #eee; padding: 10px}
  
  /* Header & Quick Info */
  .header-block { border-bottom: 2px solid #333; padding-bottom: 5px; margin-bottom: 10px; }
  .header-title { font-size: 24px; font-weight: bold; text-transform: uppercase; margin: 0; }
  .header-sub { font-style: italic; color: #555; font-size: 1.1em; }
  
  .quick-info-grid { display: flex; justify-content: space-between; background: #fafafa; padding: 8px; border-radius: 4px; margin-bottom: 15px; font-weight: bold; border: 1px solid #ddd; }
  
  /* Stats & Res Grid */
  .stat-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin-bottom: 10px; }
  .stat-box { border: 1px solid #ddd; padding: 4px; text-align: center; background: #fff; }
  .stat-label { font-weight: bold; font-size: 11px; display: block; color: #666; text-transform: uppercase; }
  .stat-value { font-size: 16px; font-weight: bold; }
  
  .res-grid { display: flex; justify-content: space-between; border-top: 1px solid #ccc; border-bottom: 1px solid #ccc; padding: 5px 0; margin-bottom: 15px; background-color: #fafafa; }
  .res-item { text-align: center; flex: 1; border-right: 1px solid #eee; }
  .res-item:last-child { border-right: none; }

  /* Sections Common */
  .section-title { background: #333; color: #fff; padding: 4px 8px; font-weight: bold; margin-top: 20px; margin-bottom: 8px; border-radius: 3px; font-size: 1.1em; }
  
  /* Defense Section */
  .defense-container { display: flex; gap: 20px; margin-bottom: 15px; }
  .defense-left { flex: 1; }
  .defense-right { flex: 1; }

  /* Tactical Table */
  .tactical-table { width: 100%; border-collapse: collapse; font-size: 0.9em; text-align: center; }
  .tactical-table th { background: #eee; padding: 4px; border: 1px solid #ccc; }
  .tactical-table td { border: 1px solid #ccc; padding: 4px; }

  /* Armor Grid */
  .armor-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px; margin-top: 5px; }
  .armor-box { border: 1px dashed #999; padding: 5px; font-size: 0.85em; background: #fff; display: flex; justify-content: space-between; align-items: center; }
  .armor-loc { font-weight: bold; text-transform: uppercase; font-size: 0.8em; color: #666; margin-right: 5px; }

  /* Attack Table */
  .attack-table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
  .attack-table th { text-align: left; border-bottom: 2px solid black; font-size: 0.9em; padding: 4px; background-color: #eee; }
  .attack-table td { border-bottom: 1px solid #eee; padding: 6px 4px; }
  .attack-ob { font-weight: bold; font-size: 1.1em; }

  /* Talents */
  .talent-group { margin-bottom: 8px; }
  .talent-group-name { font-weight: bold; text-decoration: underline; color: #444; margin-bottom: 2px; }
  .talent-list { display: flex; flex-wrap: wrap; }
  .talent-item { display: inline-block; background: #eee; padding: 2px 6px; border-radius: 3px; margin-right: 5px; margin-bottom: 2px; font-size: 0.9em; }

  /* Inventory */
  .inv-stats { display: flex; justify-content: space-around; background: #fafafa; padding: 5px; border-bottom: 1px solid #ccc; font-size: 0.9em; margin-bottom: 5px; }
  .inv-table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
  .inv-table th { text-align: left; border-bottom: 1px solid #999; padding: 2px; color: #555; }
  .inv-table td { border-bottom: 1px dotted #ccc; padding: 2px; }

  /* Skills Groups */
  .skill-list-container { columns: 2; column-gap: 20px; }
  .skill-block { break-inside: avoid; margin-bottom: 12px; }
  .skill-cat-header { 
      font-weight: bold; 
      text-transform: uppercase; 
      font-size: 0.85em; 
      background: #e8e8e8; 
      padding: 2px 5px; 
      border-left: 3px solid #666; 
      margin-bottom: 4px;
  }
  .skill-row { display: flex; justify-content: space-between; border-bottom: 1px dotted #ccc; padding: 1px 0; font-size: 0.95em; }
  .skill-bonus { font-weight: bold; }

  /* Spell Lists*/
  .spell-list-container { column-count: 2; column-gap: 20px; }
  .spell-block { break-inside: avoid; margin-bottom: 10px; }
  .spell-list-header { font-weight: bold; border-bottom: 1px solid #ccc; }
  .spell-list-type { font-size:0.8em; font-weight:normal; color:#666; }
  .spell-row { display: flex; font-size: 0.9em; }
</style>

<div class="rmu-sheet">
    <div class="header-block">
        <div class="header-title">{{header.name}}</div>
        <div class="header-sub">
            Level {{header.level}} • {{header.culture}} • {{header.race}} • {{header.profession}} • {{header.realm}} • {{header.size}}
        </div>
    </div>

    <div class="quick-info-grid">
        <span>BMR: {{quick_info.bmr_value}} ({{quick_info.bmr_mode}})</span>
        <span>Initiative: {{quick_info.initiative}}</span>
        <span>HP: {{quick_info.hits.current}} / {{quick_info.hits.max}}</span>
        <span>Physical End: {{quick_info.endurance_physical}}</span>
        <span>Mental End: {{quick_info.endurance_mental}}</span>
        <span>Power: {{quick_info.power.current}} / {{quick_info.power.max}}</span>
    </div>

    <div class="stat-grid">
        {{#each stats}}
        <div class="stat-box">
            <span class="stat-label">{{label}}</span>
            <span class="stat-value">{{temp}} ({{bonus}})</span>
        </div>
        {{/each}}
    </div>

    <div class="res-grid">
        {{#each resistances}}
        <div class="res-item">
            <div class="stat-label">{{label}}</div>
            <strong>+{{bonus}}</strong>
        </div>
        {{/each}}
    </div>

    <div class="section-title">Defenses & Armor</div>
    <div class="defense-container">
        
        <div class="defense-left">
            <div style="margin-bottom: 5px; font-weight: bold;">Base Quickness DB: {{defenses.quickness_bonus}}</div>
            <table class="tactical-table">
                <tr>
                    <th></th>
                    <th>Dodge DB</th>
                    <th>Block DB</th>
                </tr>
                {{#each defenses.tactical}}
                <tr>
                    <td>{{mode}}</td>
                    <td>{{dodge}}</td>
                    <td>{{block}}</td>
                </tr>
                {{/each}}
            </table>
        </div>

        <div class="defense-right">
            <div style="font-weight: bold; margin-bottom: 5px;">Armor Coverage</div>
            <div class="armor-grid">
                <div class="armor-box"><span class="armor-loc">Head</span> {{defenses.armor.head.name}} (AT{{defenses.armor.head.at}})</div>
                <div class="armor-box"><span class="armor-loc">Torso</span> {{defenses.armor.torso.name}} (AT{{defenses.armor.torso.at}})</div>
                <div class="armor-box"><span class="armor-loc">Arms</span> {{defenses.armor.arms.name}} (AT{{defenses.armor.arms.at}})</div>
                <div class="armor-box"><span class="armor-loc">Legs</span> {{defenses.armor.legs.name}} (AT{{defenses.armor.legs.at}})</div>
            </div>
        </div>
    </div>

    <div class="section-title">Attacks</div>
    <table class="attack-table">
        <thead>
            <tr>
                <th width="35%">Weapon</th>
                <th width="10%">OB</th>
                <th width="15%">Fumble</th>
                <th width="20%">Chart</th>
                <th width="20%">Range</th>
            </tr>
        </thead>
        <tbody>
            {{#each attacks}}
            <tr>
                <td>{{name}} - {{specialization}} {{handed}}</td>
                <td class="attack-ob">{{ob}}</td>
                <td style="color: #c00;">{{fumble}}</td>
                <td>{{damageType}}</td>
                <td>&lt;{{range}}&gt;</td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    <div class="section-title">Skills</div>
    <div class="skill-list-container">
        {{#each skill_groups}}
        <div class="skill-block">
            <div class="skill-cat-header">{{category}}</div>
            {{#each list}}
            <div class="skill-row">
                <span>{{name}}{{#if specialisation}}: {{specialisation}}{{/if}}</span>
                <span class="skill-bonus">{{bonus}} ({{ranks}})</span>
            </div>
            {{/each}}
        </div>
        {{/each}}
    </div>

    {{#if spells}}
    <div class="section-title">Spell Lists</div>
    <div class="spell-list-container">
        {{#each spells}}
        <div class="spell-block">
            <div class="spell-list-header">{{listName}} <span class="spell-list-type">({{type}})</span></div>
            {{#each spells}}
            <div class="spell-row">
                <span>{{level}}. {{name}}</span>
            </div>
            {{/each}}
        </div>
        {{/each}}
    </div>
    {{/if}}

    <div class="section-title">Inventory</div>
    <div class="inv-stats">
        <span><strong>Allowance:</strong> {{inventory.weight_allowance}}</span>
        <span><strong>Carried:</strong> {{inventory.weight_carried}}</span>
        <span><strong>Max Pace:</strong> {{inventory.max_pace}}</span>
    </div>
    <table class="inv-table">
        <thead>
            <tr>
                <th width="60%">Item</th>
                <th width="20%">Qty</th>
                <th width="20%">Weight</th>
            </tr>
        </thead>
        <tbody>
            {{#each inventory.items}}
            <tr>
                <td>{{name}}</td>
                <td>{{qty}}</td>
                <td>{{weight}}</td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    <div class="section-title">Talents</div>
    <div style="column-count: 2; column-gap: 20px;">
        {{#each talents}}
        <div class="talent-group">
            <div class="talent-group-name">{{group}}</div>
            <div class="talent-list">
                {{#each entries}}
                <span class="talent-item">• {{name}} {{tier}}</span>
                {{/each}}
            </div>
        </div>
        {{/each}}
    </div>
</div>